from easyocr import Reader

class ISO639Error(Exception): pass

class StringISO639(str):
	def __index__(self, name:str):
		return name

class Recognition:

	ISO639_3_LIST = [
		'abq',
		'abk',
		'awa',
		'ava',
		'ave',
		'ada',
		'ady',
		'aze',
		'aym',
		'ain',
		'aka',
		'akk',
		'sqi',
		'ale',
		'alt',
		'amh',
		'eng',
		'ara',
		'arw',
		'arc',
		'arp',
		'arn',
		'hye',
		'axm',
		'xcl',
		'asm',
		'aii',
		'ath',
		'aar',
		'afr',
		'afh',
		'akv',
		'nah',
		'ace',
		'ach',
		'ban',
		'bam',
		'bad',
		'bas',
		'eus',
		'bak',
		'bej',
		'bel',
		'bal',
		'bem',
		'ben',
		'bik',
		'bin',
		'mya',
		'bis',
		'bul',
		'bos',
		'brh',
		'bre',
		'bug',
		'bua',
		'bho',
		'vai',
		'cym',
		'war',
		'was',
		'hun',
		'ven',
		'vep',
		'wal',
		'vol',
		'wol',
		'vie',
		'gaa',
		'haw',
		'gag',
		'gay',
		'glg',
		'lug',
		'her',
		'gez',
		'gil',
		'gon',
		'got',
		'grb',
		'kal',
		'ell',
		'kat',
		'grn',
		'guj',
		'gla',
		'dak',
		'dar',
		'prs',
		'dan',
		'del',
		'dzo',
		'div',
		'din',
		'dyu',
		'doi',
		'grc',
		'egy',
		'orv',
		'osx',
		'dua',
		'dng',
		'jrb',
		'jpr',
		'zen',
		'zul',
		'zun',
		'iba',
		'heb',
		'ibo',
		'yid',
		'ilo',
		'inh',
		'ind',
		'ina',
		'ile',
		'iku',
		'ipk',
		'gle',
		'isl',
		'spa',
		'ita',
		'itl',
		'yor',
		'kbd',
		'kab',
		'kaw',
		'cad',
		'kaz',
		'xal',
		'kam',
		'kan',
		'kau',
		'kdr',
		'kaa',
		'krc',
		'krl',
		'car',
		'cat',
		'kac',
		'kas',
		'que',
		'kik',
		'kua',
		'kir',
		'zho',
		'tlh',
		'kom',
		'koi',
		'kon',
		'kok',
		'cop',
		'kor',
		'cor',
		'cos',
		'kpy',
		'xho',
		'kpe',
		'mus',
		'crh',
		'kum',
		'kur',
		'kru',
		'kos',
		'kut',
		'kha',
		'khm',
		'lad',
		'lbe',
		'lam',
		'lao',
		'lat',
		'lav',
		'lah',
		'lez',
		'lin',
		'lit',
		'loz',
		'lub',
		'lui',
		'lun',
		'luo',
		'ltz',
		'mag',
		'mad',
		'mai',
		'mak',
		'mkd',
		'mlg',
		'msa',
		'mal',
		'mlt',
		'man',
		'mni',
		'mns',
		'mri',
		'mar',
		'mwr',
		'chm',
		'mah',
		'mas',
		'men',
		'mer',
		'mic',
		'min',
		'mdf',
		'mol',
		'lol',
		'mon',
		'mos',
		'moh',
		'glv',
		'nav',
		'gld',
		'nau',
		'nde',
		'nbl',
		'ndo',
		'new',
		'und',
		'deu',
		'yrk',
		'nep',
		'nzi',
		'niv',
		'nld',
		'dum',
		'niu',
		'nog',
		'nor',
		'nyo',
		'nym',
		'nya',
		'nyn',
		'nno',
		'oji',
		'oci',
		'ori',
		'orm',
		'osa',
		'oss',
		'pau',
		'pli',
		'pam',
		'pag',
		'pan',
		'pap',
		'fas',
		'pal',
		'pol',
		'pon',
		'por',
		'pus',
		'raj',
		'mul',
		'rar',
		'roh',
		'kin',
		'ron',
		'run',
		'rus',
		'rut',
		'smi',
		'sam',
		'smo',
		'sag',
		'sad',
		'san',
		'zap',
		'srd',
		'ssw',
		'ceb',
		'sel',
		'srp',
		'srr',
		'sid',
		'bla',
		'sin',
		'snd',
		'syr',
		'slk',
		'slv',
		'sog',
		'som',
		'nso',
		'sot',
		'enm',
		'gmh',
		'mga',
		'frm',
		'ang',
		'goh',
		'sga',
		'non',
		'peo',
		'pro',
		'ota',
		'fro',
		'swa',
		'suk',
		'sun',
		'sus',
		'tab',
		'tgl',
		'tgk',
		'tha',
		'tah',
		'tly',
		'tmh',
		'tam',
		'tat',
		'twi',
		'tel',
		'tem',
		'ter',
		'bod',
		'tiw',
		'tig',
		'tir',
		'tli',
		'tog',
		'ton',
		'chk',
		'tsn',
		'tso',
		'tyv',
		'tum',
		'tur',
		'tuk',
		'uga',
		'udm',
		'ude',
		'uzb',
		'uig',
		'ukr',
		'ulc',
		'umb',
		'urd',
		'fan',
		'fat',
		'fao',
		'fij',
		'fil',
		'phn',
		'fin',
		'fon',
		'fra',
		'fry',
		'ful',
		'hai',
		'kjh',
		'kca',
		'hau',
		'hil',
		'hin',
		'hmo',
		'hrv',
		'kho',
		'hup',
		'tkr',
		'chu',
		'tsi',
		'rom',
		'chg',
		'cha',
		'chy',
		'chr',
		'che',
		'ces',
		'zha',
		'chb',
		'chn',
		'cho',
		'chv',
		'ckt',
		'shn',
		'swe',
		'sna',
		'cjs',
		'sco',
		'sgh',
		'sux',
		'ewe',
		'evn',
		'eve',
		'ewo',
		'eka',
		'elx',
		'myv',
		'epo',
		'est',
		'efi',
		'jav',
		'sah',
		'yao',
		'yap',
		'jpn'
	]

	def __init__(self):
		self.lang_list = ['eng']
		self.reader = Reader(self.lang_list)
		
	def change_lang(self, new_lang:StringISO639='eng') -> str:
		if (new_lang in self.ISO639_3_LIST):
			self.lang_list.append(new_lang)
			self.reader = Reader(self.lang_list)
		else:
			raise ISO639Error(
				f'{new_lang} not in list of language type ISO-639-3',
				'https://ru.wikipedia.org/wiki/Коды_языков#ISO_639'
			)

	def recognize(self, path_to_file:str=None) -> str:
		return self.reader.readtext(path_to_file, detail=0)